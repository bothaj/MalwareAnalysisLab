@{
    ViewBag.Title = "Malware Sample Analysed Results";
}
@section featured {
    <section class="featured">
        <div class="content-wrapper">
            <hgroup class="title">
                <h1>@ViewBag.Title</h1>
                <h2>@ViewBag.Message</h2>
            </hgroup>
            <p>
                
            </p>
            <p>
                
            </p>
        </div>
    </section>
}

<ol class="round">

    <div class="bs-docs-section">

        <div class="row">
          <div class="col-lg-12">
           <div class="bs-example">              

               <body onload="drawTreeGrid();">
                <div id="mytreegrid"></div>
              </body>

            </div><!-- /example -->
          </div>
        </div>
      </div>

    
</ol>

<script type="text/javascript">
            // Called when the page is loaded
            function drawTreeGrid() {
                
                var data = [
                  
                      @foreach (var item in Model)
                      {
                          <text>
                          {
                              "_icons": [{ "image": "../../Images/warning_bug.png", "height": "22px", "title": "Files" }],
                              "Sample Name": '@item.SampleName',
                              "Computer Name": '@item.PCName',
                              "IP Address": '@item.IPAddress',
                              "Operating System": '@item.OperatingSystem',
                              "Date Analysed": '@item.dtCreate',
                              "Header Type": [
                          </text>
                          foreach (var headerType in item.HeaderTypes)
                          {
                            <text>
                            {
                            </text>
                                if (headerType.Category == "Files")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/folder_system.png", "height": "22px", "title": "Files" }],
                                    </text>
                                }
                                else if (headerType.Category == "Groups")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/user_group.png", "height": "22px", "title": "Groups" }],
                                    </text>
                                }
                                else if (headerType.Category == "Registry")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/registry_system.png", "height": "22px", "title": "Registry" }],
                                    </text>
                                }
                                else if (headerType.Category == "Rights")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/rights.png", "height": "22px", "title": "Rights" }],
                                    </text>
                                }
                                else if (headerType.Category == "Schedular")
                                {
                                    <text>
                                "_icons": [{ "image": "../../Images/schedular.png", "height": "22px", "title": "Schedular" }],
                                    </text>
                                }
                                else if (headerType.Category == "Services")
                                {
                                    <text>
                                "_icons": [{ "image": "../../Images/system_services.png", "height": "22px", "title": "Services" }],
                                    </text>
                                }
                                else if (headerType.Category == "Shares")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/folder_share.png", "height": "22px", "title": "Shares" }],
                                    </text>
                                }
                                else if (headerType.Category == "System")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/system.png", "height": "22px", "title": "System" }],
                                    </text>
                                }
                                else if (headerType.Category == "Users")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/users.png", "height": "22px", "title": "Users" }],
                                    </text>
                                }
                                else if (headerType.Category == "Volumes")
                                {
                                    <text>
                                    "_icons": [{ "image": "../../Images/volumes.png", "height": "22px", "title": "Volumes" }],
                                    </text>
                                }
                                else if (headerType.Category == "Network")
                                {
                                    <text>
                                "_icons": [{ "image": "../../Images/network.png", "height": "22px", "title": "Network" }],
                                    </text>
                                }
                                else if (headerType.Category == "File Inspection")
                                {
                                    <text>
                                "_icons": [{ "image": "../../Images/file_inspection.png", "height": "22px", "title": "File Inspection" }],
                                    </text>
                                }
                                <text>
                                "Class": '@headerType.Category',
                                "Critical": '@headerType.Critical',
                                "Warning": '@headerType.Warning',
                                "Info": '@headerType.Info',
                                "Ignored": '@headerType.Ignored',
                                "Test Date": '@headerType.dtTested',
                                "Snapshot Date": '@headerType.dtSnapshot',
                                "Header": [
                            </text>
                                foreach (var header in headerType.MalwareHeaderModels)
                                {
                                <text>
                                {
                                    "Sub-Class": '@header.HeaderName',
                                    "Critical": '@header.Critical',
                                    "Warning": '@header.Warning',
                                    "Info": '@header.Info',
                                    "Ignored": '@header.Ignored',
                                    "Header Details": [
                                </text>
                                    foreach (var detail in header.MalwareHeaderDetailsModels)
                                    {
                                        <text>
                                        {
                                        </text>
                                        if (detail.Severity == "Critical")
                                        {
                                                <text>
                                                "_icons": [{"image": "../../Images/critical.png", "height":"22px", "title": "Critical"}],
                                                </text>
                                        }
                                        else if (detail.Severity == "Warning")
                                        {
                                                <text>
                                                "_icons": [{ "image": "../../Images/warning.png", "height": "22px", "title": "Warning" }],
                                                </text>
                                        }
                                        else if (detail.Severity == "Info")
                                        {
                                                <text>
                                                "_icons": [{ "image": "../../Images/info.png", "height": "22px", "title": "Info" }],
                                                </text>
                                        }
                                        else if (detail.Severity == "Ignored")
                                        {
                                                <text>
                                                "_icons": [{ "image": "../../Images/ignored.png", "height": "22px", "title": "Ignored" }],
                                                </text>
                                        }
                                        else
                                        {
                                                <text>
                                                "_icons": [{ "image": "../../Images/unknown.png", "height": "22px", "title": "Unknown" }],
                                                </text>
                                        }
                                            <text>   
                                            "Description": '@detail.ActivityDescription',
                                            "Info": '@detail.ActivityName',
                                            "From Value": '@detail.FromValue',
                                            "To Value": '@detail.ToValue'
                                        },
                                        </text>
                                    }
                                      <text>
                                      ]
                                  },
                                  </text>
                                }
                                  <text>
                                ]
                            },
                            </text>
                          }
                            <text>
                           ]
                          }, 
                          </text>
                      }
                ];

                // specify options
                var options = {
                    'width': '1300px',
                    'height': '400px',
                    'Autofit': 'BOTH'
                };

                // Instantiate our treegrid object.
                var container = document.getElementById('mytreegrid');
                var treegrid = new links.TreeGrid(container, options);

                //treegrid.setWidth("100%");
                //treegrid.setHeight("100%");

                //treegrid.setFixedFieldWidths(false);

                //treegrid.setAutoFitData(Autofit.BOTH);

                // Draw our treegrid with the created data and options
                treegrid.draw(data);

               
            }
   </script>
